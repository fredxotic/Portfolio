{% extends "base.html" %}
{% load static %}
{% load portfolio_filters %}

{% block title %}{{ project.title }} â€” Project Details{% endblock %}

{% block meta %}
  <meta name="description" content="{{ project.short_description }}">
  <meta property="og:type" content="article">
  <meta property="og:title" content="{{ project.title }}">
  <meta property="og:description" content="{{ project.short_description }}">
  {% if project.thumbnail %}<meta property="og:image" content="{{ project.thumbnail.url }}">{% endif %}
{% endblock %}

{% block body_attrs %} class="fk-detail-page"{% endblock %}
{% block navbar_class %} fk-navbar--solid{% endblock %}

{% block nav_items %}
          <li><a href="{% url 'home' %}#hero" class="fk-nav-link">Home</a></li>
          <li><a href="{% url 'home' %}#about" class="fk-nav-link">About</a></li>
          <li><a href="{% url 'home' %}#portfolio" class="fk-nav-link active">Projects</a></li>
          <li><a href="{% url 'home' %}#contact" class="fk-nav-link">Contact</a></li>
{% endblock %}

{% block content %}

    <!-- PROJECT HERO -->
    <section class="fk-detail-hero">
      <div class="fk-detail-hero__bg">
        {% if project.thumbnail %}
          <img src="{{ project.thumbnail.url }}" alt="{{ project.title }}" class="fk-detail-hero__bg-img">
        {% endif %}
        <div class="fk-detail-hero__overlay"></div>
      </div>
      <div class="container">
        <div class="fk-detail-hero__content" data-aos="fade-up">
          <!-- Breadcrumb -->
          <nav class="fk-breadcrumb" aria-label="Breadcrumb">
            <a href="{% url 'home' %}">Home</a>
            <i class="bi bi-chevron-right"></i>
            <a href="{% url 'home' %}#portfolio">Projects</a>
            <i class="bi bi-chevron-right"></i>
            <span>{{ project.title }}</span>
          </nav>
          <div class="fk-detail-hero__badges">
            <span class="fk-badge fk-badge--accent">{{ project.get_category_display }}</span>
            <span class="fk-badge fk-badge--muted"><i class="bi bi-calendar3 me-1"></i>{{ project.project_date }}</span>
          </div>
          <h1 class="fk-detail-hero__title">{{ project.title }}</h1>
          <p class="fk-detail-hero__subtitle">{{ project.short_description }}</p>
          <div class="fk-detail-hero__links">
            {% if project.live_url %}
            <a href="{{ project.live_url }}" target="_blank" rel="noopener" class="fk-btn fk-btn--primary">
              <i class="bi bi-box-arrow-up-right me-2"></i>Live Demo
            </a>
            {% endif %}
            {% if project.github_url %}
            <a href="{{ project.github_url }}" target="_blank" rel="noopener" class="fk-btn fk-btn--ghost">
              <i class="bi bi-github me-2"></i>Source Code
            </a>
            {% endif %}
          </div>
        </div>
      </div>
    </section>

    <!-- PROJECT CONTENT -->
    <section class="fk-section">
      <div class="container">
        <div class="row gy-5">

          <!-- Main Content -->
          <div class="col-lg-8" data-aos="fade-right">

            <!-- Main Image -->
            {% if project.thumbnail %}
            <div class="fk-detail-main-img mb-5">
              <img src="{{ project.thumbnail.url }}" alt="{{ project.title }}" class="img-fluid">
            </div>
            {% endif %}

            <!-- Overview -->
            <div class="fk-content-block mb-5">
              <h2 class="fk-content-block__title">Project Overview</h2>
              <div class="fk-content-block__body">
                {{ project.description|linebreaks }}
              </div>
            </div>

            <!-- Detailed Content -->
            {% if project.detailed_content %}
            <div class="fk-content-block mb-5">
              <h2 class="fk-content-block__title">Technical Deep Dive</h2>
              <div class="fk-content-block__body fk-rich-text">
                {{ project.detailed_content|richtext }}
              </div>
            </div>
            {% endif %}

            <!-- Gallery -->
            {% if project.images.all %}
            <div class="fk-content-block mb-5">
              <h2 class="fk-content-block__title">Gallery</h2>
              <div class="row gy-3">
                {% for img in project.images.all %}
                <div class="col-sm-6">
                  <a href="{{ img.image.url }}" class="glightbox fk-gallery-thumb">
                    <img src="{{ img.image.url }}" alt="Project screenshot {{ forloop.counter }}" class="img-fluid" loading="lazy">
                    <div class="fk-gallery-thumb__overlay"><i class="bi bi-zoom-in"></i></div>
                  </a>
                </div>
                {% endfor %}
              </div>
            </div>
            {% endif %}

          </div>

          <!-- Sidebar -->
          <div class="col-lg-4" data-aos="fade-left" data-aos-delay="100">
            <div class="fk-detail-sidebar">

              <!-- Project Info -->
              <div class="fk-sidebar-card mb-4">
                <h3 class="fk-sidebar-card__title">Project Info</h3>
                <ul class="fk-sidebar-info-list">
                  <li>
                    <span class="fk-sidebar-info-list__label"><i class="bi bi-calendar3"></i> Date</span>
                    <span>{{ project.project_date }}</span>
                  </li>
                  <li>
                    <span class="fk-sidebar-info-list__label"><i class="bi bi-folder2"></i> Category</span>
                    <span>{{ project.get_category_display }}</span>
                  </li>
                  {% if project.tech_stack %}
                  <li>
                    <span class="fk-sidebar-info-list__label"><i class="bi bi-stack"></i> Stack</span>
                    <span>{{ project.tech_stack }}</span>
                  </li>
                  {% endif %}
                </ul>
              </div>

              <!-- Technologies -->
              {% if project.tags.all %}
              <div class="fk-sidebar-card mb-4">
                <h3 class="fk-sidebar-card__title">Technologies</h3>
                <div class="fk-tag-grid">
                  {% for tag in project.tags.all %}
                  <span class="fk-tag"><i class="bi bi-check2-circle me-1"></i>{{ tag.name }}</span>
                  {% endfor %}
                </div>
              </div>
              {% endif %}

              <!-- Links -->
              {% if project.live_url or project.github_url %}
              <div class="fk-sidebar-card mb-4">
                <h3 class="fk-sidebar-card__title">Links</h3>
                <div class="d-grid gap-2">
                  {% if project.live_url %}
                  <a href="{{ project.live_url }}" target="_blank" rel="noopener" class="fk-btn fk-btn--primary">
                    <i class="bi bi-box-arrow-up-right me-2"></i>View Live Project
                  </a>
                  {% endif %}
                  {% if project.github_url %}
                  <a href="{{ project.github_url }}" target="_blank" rel="noopener" class="fk-btn fk-btn--outline">
                    <i class="bi bi-github me-2"></i>View Source Code
                  </a>
                  {% endif %}
                </div>
              </div>
              {% endif %}

              <!-- Back button -->
              <a href="{% url 'home' %}#portfolio" class="fk-btn fk-btn--ghost w-100">
                <i class="bi bi-arrow-left me-2"></i>Back to Portfolio
              </a>

            </div>
          </div>

        </div>
      </div>
    </section>

    <!-- RELATED PROJECTS -->
    {% if related_projects %}
    <section class="fk-section fk-section--alt">
      <div class="container">
        <div class="fk-section-header fk-section-header--left mb-4" data-aos="fade-up">
          <span class="fk-section-header__tag">More Work</span>
          <h2 class="fk-section-header__title" style="font-size:2rem;">Related Projects</h2>
        </div>
        <div class="row gy-4">
          {% for rel in related_projects %}
          <div class="col-lg-4 col-md-6" data-aos="fade-up" data-aos-delay="{% widthratio forloop.counter0 1 100 %}">
            {% include "includes/project_card.html" with card_project=rel %}
          </div>
          {% endfor %}
        </div>
      </div>
    </section>
    {% endif %}

{% endblock %}

{% block footer_columns %}
        <div class="col-lg-2 col-sm-4">
          <h5 class="fk-footer__heading">Navigation</h5>
          <ul class="fk-footer__links">
            <li><a href="{% url 'home' %}">Home</a></li>
            <li><a href="{% url 'home' %}#about">About</a></li>
            <li><a href="{% url 'home' %}#portfolio">Projects</a></li>
            <li><a href="{% url 'home' %}#contact">Contact</a></li>
          </ul>
        </div>
        <div class="col-lg-3 col-sm-4 offset-lg-2">
          <h5 class="fk-footer__heading">Contact</h5>
          {% if profile %}
          <ul class="fk-footer__contact-list">
            <li><i class="bi bi-geo-alt-fill"></i> {{ profile.location }}</li>
            <li><i class="bi bi-envelope-fill"></i> <a href="mailto:{{ profile.email }}">{{ profile.email }}</a></li>
          </ul>
          {% endif %}
        </div>
{% endblock %}
