{% extends "base.html" %}
{% load static %}

{% block title %}{% if profile %}{{ profile.name }} â€” Portfolio{% else %}Portfolio{% endif %}{% endblock %}

{% block meta %}
  <meta name="description" content="{% if profile %}{{ profile.bio|truncatewords:30 }}{% else %}Personal portfolio{% endif %}">
  <meta property="og:type" content="website">
  <meta property="og:title" content="{% if profile %}{{ profile.name }} â€” Portfolio{% else %}Portfolio{% endif %}">
  <meta property="og:description" content="{% if profile %}{{ profile.bio|truncatewords:25 }}{% endif %}">
  {% if profile and profile.profile_image %}<meta property="og:image" content="{{ profile.profile_image.url }}">{% endif %}
{% endblock %}

{% block preloader %}
  <div id="preloader" class="fk-preloader"><div class="fk-preloader__ring"></div></div>
{% endblock %}

{% block nav_items %}
          <li><a href="#hero" class="fk-nav-link active">Home</a></li>
          <li><a href="#about" class="fk-nav-link">About</a></li>
          <li><a href="#resume" class="fk-nav-link">Education</a></li>
          <li><a href="#interests" class="fk-nav-link">Interests</a></li>
          <li><a href="#portfolio" class="fk-nav-link">Projects</a></li>
          <li><a href="#contact" class="fk-nav-link">Contact</a></li>
{% endblock %}

{% block content %}

    <!-- HERO -->
    <section id="hero" class="fk-hero">
      <div class="fk-hero__bg">
        {% if profile and profile.hero_image %}
          <img src="{{ profile.hero_image.url }}" alt="Background" class="fk-hero__bg-img">
        {% else %}
          <img src="{% static 'img/me.jpg' %}" alt="Background" class="fk-hero__bg-img">
        {% endif %}
        <div class="fk-hero__overlay"></div>
        <div class="fk-hero__grid"></div>
      </div>
      <div class="fk-hero__content" data-aos="fade-up">
        <p class="fk-hero__greeting">Hello, world! ðŸ‘‹ I'm</p>
        <h1 class="fk-hero__name">{% if profile %}{{ profile.name }}{% else %}Fred Kaloki{% endif %}</h1>
        <div class="fk-hero__role-wrapper">
          <span class="fk-hero__role-prefix">I'm a&nbsp;</span>
          <span id="typedEl" data-typed-items="{% if profile %}{{ profile.get_typed_titles }}{% else %}Developer{% endif %}"></span>
          <span class="fk-typed-cursor">|</span>
        </div>
        <div class="fk-hero__actions" data-aos="fade-up" data-aos-delay="150">
          <a href="#portfolio" class="fk-btn fk-btn--primary">View My Work <i class="bi bi-arrow-right-short"></i></a>
          <a href="#contact" class="fk-btn fk-btn--ghost">Get In Touch</a>
        </div>
        <div class="fk-hero__socials" data-aos="fade-up" data-aos-delay="250">
          {% include "includes/social_links.html" %}
          {% if profile %}<a href="mailto:{{ profile.email }}" aria-label="Email"><i class="bi bi-envelope-fill"></i></a>{% endif %}
        </div>
      </div>
      <a href="#about" class="fk-hero__scroll" aria-label="Scroll down">
        <span class="fk-hero__scroll-dot"></span>
      </a>
    </section>

    <!-- ABOUT -->
    <section id="about" class="fk-section">
      <div class="container">
        <div class="fk-section-header" data-aos="fade-up">
          <span class="fk-section-header__tag">About Me</span>
          <h2 class="fk-section-header__title">The Person Behind the Code</h2>
        </div>
        <div class="row gy-5 align-items-start">
          <div class="col-lg-4" data-aos="fade-right" data-aos-delay="100">
            <div class="fk-profile-card">
              <div class="fk-profile-card__avatar-ring">
                {% if profile and profile.profile_image %}
                  <img src="{{ profile.profile_image.url }}" alt="{{ profile.name }}" class="fk-profile-card__avatar">
                {% else %}
                  <img src="{% static 'img/me.jpg' %}" alt="Profile" class="fk-profile-card__avatar">
                {% endif %}
                <span class="fk-profile-card__status" title="Open to opportunities"></span>
              </div>
              {% if profile %}
              <h3 class="fk-profile-card__name">{{ profile.name }}</h3>
              <p class="fk-profile-card__title">{{ profile.title|truncatewords:6 }}</p>
              {% endif %}
              <div class="fk-profile-card__stats">
                <div class="fk-stat"><strong>{{ projects.count }}</strong><span>Projects</span></div>
                <div class="fk-stat"><strong>{{ certifications.count }}</strong><span>Certifications</span></div>
                <div class="fk-stat"><strong>{{ skills.count }}</strong><span>Skills</span></div>
              </div>
              <div class="fk-profile-card__actions">
                {% if profile and profile.cv_file %}
                  <a href="{{ profile.cv_file.url }}" class="fk-btn fk-btn--primary w-100" target="_blank" download><i class="bi bi-cloud-download me-2"></i>Download CV</a>
                {% else %}
                  <a href="{% static 'docs/mycv.pdf' %}" class="fk-btn fk-btn--primary w-100" target="_blank"><i class="bi bi-cloud-download me-2"></i>Download CV</a>
                {% endif %}
                <a href="#contact" class="fk-btn fk-btn--outline w-100 mt-2"><i class="bi bi-send me-2"></i>Contact Me</a>
              </div>
              <div class="fk-profile-card__info">
                {% if profile %}
                <div class="fk-info-row"><i class="bi bi-geo-alt-fill"></i><span>{{ profile.location }}</span></div>
                <div class="fk-info-row"><i class="bi bi-envelope-fill"></i><a href="mailto:{{ profile.email }}">{{ profile.email }}</a></div>
                <div class="fk-info-row"><i class="bi bi-telephone-fill"></i><a href="tel:{{ profile.phone }}">{{ profile.phone }}</a></div>
                {% endif %}
              </div>
            </div>
          </div>

          <div class="col-lg-8" data-aos="fade-left" data-aos-delay="150">
            <div class="fk-bio mb-5">
              <span class="fk-label">Biography</span>
              <h3 class="fk-bio__heading">Bridging Financial Knowledge<br>with Digital Innovation</h3>
              <div class="fk-bio__text">
                {% if profile %}{{ profile.bio|linebreaks }}{% endif %}
              </div>
            </div>
            <div class="fk-skills">
              <span class="fk-label">Core Skills</span>
              <h4 class="fk-skills__heading">Technical &amp; Professional Proficiency</h4>
              <div class="fk-skills__list skills-animation">
                {% for skill in skills %}
                <div class="fk-skill-row">
                  <div class="fk-skill-row__header">
                    <span class="fk-skill-row__name">{{ skill.name }}</span>
                    <span class="fk-skill-row__pct">{{ skill.percentage }}%</span>
                  </div>
                  <div class="fk-progress">
                    <div class="fk-progress__bar"
                         role="progressbar"
                         aria-valuenow="{{ skill.percentage }}"
                         aria-valuemin="0"
                         aria-valuemax="100"
                         data-width="{{ skill.percentage }}%"
                         style="width:0%"></div>
                  </div>
                </div>
                {% endfor %}
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- EDUCATION & CERTS -->
    <section id="resume" class="fk-section fk-section--alt">
      <div class="container">
        <div class="fk-section-header" data-aos="fade-up">
          <span class="fk-section-header__tag">Background</span>
          <h2 class="fk-section-header__title">Education &amp; Credentials</h2>
        </div>
        <div class="row gy-5">
          <div class="col-lg-6" data-aos="fade-right" data-aos-delay="100">
            <div class="fk-block-label"><i class="bi bi-mortarboard-fill me-2"></i>Academic Background</div>
            <div class="fk-timeline">
              {% for edu in education %}
              <div class="fk-timeline__item">
                <div class="fk-timeline__dot"></div>
                <div class="fk-timeline__card">
                  <div class="fk-timeline__meta">
                    <span class="fk-timeline__year">{{ edu.start_year }} â€“ {% if edu.is_current %}Present{% else %}{{ edu.end_year }}{% endif %}</span>
                    <span class="fk-badge">{{ edu.degree_level }}</span>
                  </div>
                  <h4 class="fk-timeline__title">{{ edu.degree }}</h4>
                  <p class="fk-timeline__institution"><i class="bi bi-building me-1"></i>{{ edu.institution }}</p>
                  <p class="fk-timeline__desc">{{ edu.description }}</p>
                </div>
              </div>
              {% endfor %}
            </div>
          </div>
          <div class="col-lg-6" data-aos="fade-left" data-aos-delay="100">
            <div class="fk-block-label"><i class="bi bi-patch-check-fill me-2"></i>Professional Certifications</div>
            <div class="fk-cert-grid">
              {% for cert in certifications %}
              <div class="fk-cert-card {% if cert.is_current %}fk-cert-card--active{% endif %}">
                <div class="fk-cert-card__icon"><i class="bi bi-award-fill"></i></div>
                <div class="fk-cert-card__body">
                  {% if cert.is_current %}<span class="fk-badge fk-badge--accent mb-2 d-inline-block">In Progress</span>{% endif %}
                  <h4 class="fk-cert-card__title">{{ cert.title }}</h4>
                  <p class="fk-cert-card__issuer">{{ cert.issuer }}</p>
                  <p class="fk-cert-card__desc">{{ cert.description }}</p>
                </div>
              </div>
              {% endfor %}
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- INTERESTS & CAREER ROADMAP -->
    <section id="interests" class="fk-section">
      <div class="container">
        <div class="fk-section-header" data-aos="fade-up">
          <span class="fk-section-header__tag">What Drives Me</span>
          <h2 class="fk-section-header__title">Interests &amp; Career Roadmap</h2>
          <p class="fk-section-header__sub">Exploring the intersection of Finance, Technology, and Innovation.</p>
        </div>
        <div class="row gy-4 mb-5">
          {% for interest in interests %}
          <div class="col-sm-6 col-xl-3" data-aos="fade-up" data-aos-delay="{{ forloop.counter0 }}50">
            <div class="fk-interest-card">
              <div class="fk-interest-card__icon"><i class="{{ interest.icon }}"></i></div>
              <h4 class="fk-interest-card__title">{{ interest.title }}</h4>
              <p class="fk-interest-card__desc">{{ interest.description }}</p>
            </div>
          </div>
          {% endfor %}
        </div>
        <div class="fk-section-header fk-section-header--left mt-4 mb-4" data-aos="fade-up">
          <span class="fk-section-header__tag">Roadmap</span>
          <h3 class="fk-section-header__title" style="font-size:2rem;">Career Goals</h3>
        </div>
        <div class="row gy-4">
          {% for goal in career_goals %}
          <div class="col-lg-4" data-aos="fade-up" data-aos-delay="{% widthratio forloop.counter0 1 100 %}">
            <div class="fk-goal-card">
              <div class="fk-goal-card__header">
                <span class="fk-goal-card__timeframe">{{ goal.get_timeframe_display }}</span>
                <h4 class="fk-goal-card__title">{{ goal.title }}</h4>
              </div>
              <ul class="fk-goal-list">
                {% for item in goal.get_goals_list %}
                <li><i class="bi bi-check2-circle"></i> {{ item }}</li>
                {% endfor %}
              </ul>
            </div>
          </div>
          {% endfor %}
        </div>
      </div>
    </section>

    <!-- PORTFOLIO -->
    <section id="portfolio" class="fk-section fk-section--alt">
      <div class="container">
        <div class="fk-section-header" data-aos="fade-up">
          <span class="fk-section-header__tag">Work</span>
          <h2 class="fk-section-header__title">Featured Projects</h2>
          <p class="fk-section-header__sub">Full-stack development, AI integration, and real-world problem solving.</p>
        </div>
        <div class="fk-portfolio-filters" data-aos="fade-up" data-aos-delay="100">
          <button class="fk-filter-btn active" data-filter="*">All</button>
          <button class="fk-filter-btn" data-filter=".filter-ai">AI &amp; Data Science</button>
          <button class="fk-filter-btn" data-filter=".filter-web">Web Dev</button>
          <button class="fk-filter-btn" data-filter=".filter-mobile">Mobile</button>
          <button class="fk-filter-btn" data-filter=".filter-other">Other</button>
        </div>
        <div class="row gy-4 isotope-container" data-aos="fade-up" data-aos-delay="200">
          {% for project in projects %}
          <div class="col-lg-4 col-md-6 isotope-item filter-{{ project.category|lower }}">
            {% include "includes/project_card.html" with card_project=project %}
          </div>
          {% endfor %}
        </div>
      </div>
    </section>

    <!-- CONTACT -->
    <section id="contact" class="fk-section">
      <div class="container">
        <div class="fk-section-header" data-aos="fade-up">
          <span class="fk-section-header__tag">Say Hello</span>
          <h2 class="fk-section-header__title">Get In Touch</h2>
          <p class="fk-section-header__sub">Open to opportunities, collaborations, or a good conversation about tech and finance.</p>
        </div>
        <div class="row gy-5">
          <div class="col-lg-4" data-aos="fade-right" data-aos-delay="100">
            <div class="fk-contact-info">
              {% if profile %}
              <div class="fk-contact-info__item">
                <div class="fk-contact-info__icon"><i class="bi bi-geo-alt-fill"></i></div>
                <div><h5>Location</h5><p>{{ profile.location }}</p></div>
              </div>
              <div class="fk-contact-info__item">
                <div class="fk-contact-info__icon"><i class="bi bi-telephone-fill"></i></div>
                <div><h5>Phone</h5><p><a href="tel:{{ profile.phone }}">{{ profile.phone }}</a></p></div>
              </div>
              <div class="fk-contact-info__item">
                <div class="fk-contact-info__icon"><i class="bi bi-envelope-fill"></i></div>
                <div><h5>Email</h5><p><a href="mailto:{{ profile.email }}">{{ profile.email }}</a></p></div>
              </div>
              {% endif %}
              <div class="fk-contact-socials mt-4">
                {% include "includes/social_links.html" %}
              </div>
            </div>
          </div>
          <div class="col-lg-8" data-aos="fade-left" data-aos-delay="150">
            {% if messages %}
              {% for message in messages %}
              <div class="fk-alert fk-alert--{{ message.tags }}">
                <i class="bi {% if 'success' in message.tags %}bi-check-circle-fill{% else %}bi-exclamation-triangle-fill{% endif %} me-2"></i>
                {{ message }}
                <button type="button" onclick="this.parentElement.remove()" class="fk-alert__close">&times;</button>
              </div>
              {% endfor %}
            {% endif %}
            <form action="{% url 'home' %}#contact" method="post" class="fk-contact-form" id="contactForm">
              {% csrf_token %}
              <div class="row gy-3">
                <div class="col-sm-6">
                  <div class="fk-form-group">
                    <label for="{{ form.name.id_for_label }}" class="fk-form-label">Your Name</label>
                    {{ form.name }}
                    {% if form.name.errors %}<div class="fk-form-error">{{ form.name.errors.0 }}</div>{% endif %}
                  </div>
                </div>
                <div class="col-sm-6">
                  <div class="fk-form-group">
                    <label for="{{ form.email.id_for_label }}" class="fk-form-label">Email Address</label>
                    {{ form.email }}
                    {% if form.email.errors %}<div class="fk-form-error">{{ form.email.errors.0 }}</div>{% endif %}
                  </div>
                </div>
                <div class="col-12">
                  <div class="fk-form-group">
                    <label for="{{ form.subject.id_for_label }}" class="fk-form-label">Subject</label>
                    {{ form.subject }}
                    {% if form.subject.errors %}<div class="fk-form-error">{{ form.subject.errors.0 }}</div>{% endif %}
                  </div>
                </div>
                <div class="col-12">
                  <div class="fk-form-group">
                    <label for="{{ form.message.id_for_label }}" class="fk-form-label">Message</label>
                    {{ form.message }}
                    {% if form.message.errors %}<div class="fk-form-error">{{ form.message.errors.0 }}</div>{% endif %}
                  </div>
                </div>
                <div class="col-12">
                  <button type="submit" class="fk-btn fk-btn--primary">Send Message <i class="bi bi-send-fill ms-2"></i></button>
                </div>
              </div>
            </form>
          </div>
        </div>
      </div>
    </section>

{% endblock %}

{% block footer_columns %}
        <div class="col-lg-2 col-sm-4">
          <h5 class="fk-footer__heading">Quick Links</h5>
          <ul class="fk-footer__links">
            <li><a href="#hero">Home</a></li>
            <li><a href="#about">About</a></li>
            <li><a href="#resume">Education</a></li>
            <li><a href="#portfolio">Projects</a></li>
            <li><a href="#contact">Contact</a></li>
          </ul>
        </div>
        <div class="col-lg-2 col-sm-4">
          <h5 class="fk-footer__heading">Skills</h5>
          <ul class="fk-footer__links">
            {% for skill in skills|slice:":5" %}
            <li><a href="#about">{{ skill.name }}</a></li>
            {% endfor %}
          </ul>
        </div>
        <div class="col-lg-3 col-sm-4">
          <h5 class="fk-footer__heading">Contact</h5>
          {% if profile %}
          <ul class="fk-footer__contact-list">
            <li><i class="bi bi-geo-alt-fill"></i> {{ profile.location }}</li>
            <li><i class="bi bi-telephone-fill"></i> <a href="tel:{{ profile.phone }}">{{ profile.phone }}</a></li>
            <li><i class="bi bi-envelope-fill"></i> <a href="mailto:{{ profile.email }}">{{ profile.email }}</a></li>
          </ul>
          {% endif %}
        </div>
{% endblock %}

{% block extra_js %}
  <script src="{% static 'vendor/typed.js/typed.umd.js' %}"></script>
  <script src="{% static 'vendor/waypoints/noframework.waypoints.js' %}"></script>
  <script src="{% static 'vendor/imagesloaded/imagesloaded.pkgd.min.js' %}"></script>
  <script src="{% static 'vendor/isotope-layout/isotope.pkgd.min.js' %}"></script>
{% endblock %}
